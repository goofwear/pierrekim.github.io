-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

## Advisory Information

Title: FreeBSD 10.x ZFS encryption.key disclosure (CVE-2015-1415)
Advisory URL: https://pierrekim.github.com/advisories/CVE-2015-1415.txt.asc
Date published: 2015-04-07
Vendors contacted: FreeBSD
Release mode: Coordinated release



## Product Description

FreeBSD is a UNIX-like operating system.



## Vulnerability Summary

FreeBSD 10.x installer supports the installation of FreeBSD 10.x  on  an
encrypted ZFS filesystem by default.

When using the encryption system within ZFS during the  installation  of
FreeBSD 10.0 and FreeBSD 10.1, the encryption.key has wrong  permissions
which allow local users to read this file.

Even if the keyfile is passphrase-encrypted, it can present a risk.



## Details

By default, the encryption key file is /boot/encryption.key.

Instead of being 0600, the permissions are 0644:

$ ls -la /boot/encryption.key
- -rw-r--r--  1 root  wheel  4096 Feb 17 15:16 /boot/encryption.key
$

This file is readable by a local user.



## Vendor Response

According to the vendor, a security advisory will be published, describing
the problem and the solution. It concerns:

    - stable/10, 10.1-STABLE
    - releng/10.1, 10.1-RELEASE-p8
    - releng/10.0, 10.0-RELEASE-p18


## Report Timeline

 * Mar 01, 2015: Problem found by Pierre Kim
 * Apr 01, 2015: Vendor is notified of the vulnerability
 * Apr 01, 2015: Vendor confirms report and indicates a fix is  prepared
   but there will be no security advisory format notification because of
   the nature of the problem
 * Apr 02, 2015: Pierre Kim asks a CVE number to the vendor
 * Apr 02, 2015: Vendor indicates to use CVE-2015-1415  and  confirms that a
   signed notification to the mailing lists will be sent.
 * Apr 03, 2015: Pierre Kim contacts FreeBSD about the future notification
 * Apr 04, 2015: Vendor confirms a security advisory will be published
   next week
 * Apr 07, 2015: Vendor publishes a security advisory (FreeBSD-SA-15:08)
 * Apt 07, 2015: This advisory is sent to bugtraq@



## Credit

This vulnerability was found by Pierre Kim (@PierreKimSec).



## References

https://www.freebsd.org/doc/handbook/bsdinstall-partitioning.html
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1415
https://www.freebsd.org/security/advisories/FreeBSD-SA-15:08.bsdinstall.asc



## Disclaimer

This advisory is licensed under a Creative Commons Attribution Non-Commercial
Share-Alike 3.0 License: http://creativecommons.org/licenses/by-nc-sa/3.0/
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJVJFxwAAoJEMQ+Dtp9ky28bsoQAIaP9e0b5KLmqPBUkqKoXhgL
jUwsFaEODtkvIqI/sLTKpHWhRi3s6d/MDuGLsI4REyu1ZwKdxqzX0n2fo1dyB1dI
bKCDLTl7bI5Z6Fc0iZHfMj/dCimWUXsPM0h5J101QQ5+IEWzghnn7Htc6X8QrKfH
ijJ83f7wZBPophBFdlLNFnzkd6enFDercqR13/LmXZKdaZe3dgluV2Tj3HUxpU7Y
nsMIM0rNgWZt/0tnEnaqXmGipauiGc7fqSOqgzDPFIRVkbtQ+ed4t1ZsuLmUh+LV
5qFnP3tDX0pnVMcTJM9SgeYsepLrBGTewwzHsls1XI4A2Xf44IsIY8I6zZ34rxDp
PsSE8XhL1/8xjoep8zBBrqps7uvJncW/2+k2mgxikvwWRMG0okrS+3PNsE3E2iWb
1UUUoB4+SlZ+mkxKZjTR5jQs4CEgIXmEy67Ifyi0LJydo7P2koMmFCP7YMWTKksh
lFbihqKpoIAgxuIBRRhaV6uaDELjN5FTOSAPgcnMjYZvWHNYpfbTvcOBU2Zv3H1H
DpzAqkmJRvVtyYR+EbsaH2PiQR54jlcVCGCAdrsLsv4P4Qvbix7MbhxI2UrR4sB3
m2nV485MN5q4elAsCdDUKbE4KINxkKAm+uFGopac1TTEvhnzxhdq8cH+KfzgWp+Q
vZ54F6QIeXyZXFbcsCv5
=+9wC
-----END PGP SIGNATURE-----
