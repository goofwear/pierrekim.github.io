<!DOCTYPE html>
<html>
<head>
<title>A slice of Kimchi - IT Security Blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="feed.xml" rel="alternate" type="application/rss+xml" title="Blog" />
<style>
body {
    font-family: sans-serif;
    background-color: #fff;
    font-size: 16px;
}
h1, h2, h3, h4 {
    font-family: arial;
}
.container {
    max-width: 900px;
}
.footer {
    margin-top: 50px;
    font-size: 12px;
    text-align: center;
}
</style>
</head>
<body>
<div class="container">
    <div class="hero-unit faq">
        <div class="ac" style="text-align: center;">
            <h1>A slice of Kimchi - IT Security Blog</h1>
            <a href="../index.html">Home</a> &bull; <a href="about.html">About</a>  &bull; <a href="feed.xml">Feed</a>
        </div>
    </div>
    

    <div class="hero-unit faq">
        <div class="ac">
            <h2><a href="2015-08-10-watching-SBS-and-KBS-in-a-remote-country.html">Watching SBS and KBS in a remote country</a></h2>
        </div>
    </div>

    <div>
        <p>SBS and KBS are Korean TV networks and they provide TV streaming, but they are using fancy flash players (hello 100% used CPU) and SBS even asks a passport for foreigners to get access to the streams. Koreans can have access after being authentified to their services.</p>
<p>As I have a personal fight to provide access to K-POP for EVERYBODY and because I have to travel to different countries, I've prepared this article that will explain how to watch SBS, KBS1 and KBS2 without authentication.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Real_Time_Messaging_Protocol">RTMP</a> streams are protected using tokens.</p>
<p>A working RTMP request, with the one-time-token:
<img alt="" src="images/sbs-wireshark.png" /></p>
<p>By sniffing the traffic and decompiling the SWFs file, I discovered how to easily generate tokens:</p>
<p>The SWF in SBS website forces the browser to get a token by connecting to API (SBS). The SWFs in KBS* websites get the token directly in the webpage.</p>
<h2>Watching SBS:</h2>
<p>Sending this wget request will provide you the valid secure token:</p>
<pre><code>wget -qO- --user-agent='YOUR_USER_AGENT' \
  'http://api.sbs.co.kr/vod/_v1/Onair_Media_Auth.jsp?playerType=flash&amp;channelPath=sbsch6pc&amp;streamName=sbs1ch63.stream' | sed -e 's/\(.*\)q=\(.*\)/\2/'
TOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTO%3D%3D
</code></pre>
<p>This script will allows you to watch SBS:</p>
<pre><code>#!/bin/sh

token=$(wget -qO- --user-agent='YOUR_USER_AGENT' \
  'http://api.sbs.co.kr/vod/_v1/Onair_Media_Auth.jsp?playerType=flash&amp;channelPath=sbsch6pc&amp;streamName=sbs1ch63.stream' | sed -e 's/\(.*\)q=\(.*\)/\2/')
rtmpdump --resume -r "rtmp://nlive.sbs.co.kr/sbsch6pc/sbs1ch63.stream?u=sbs&amp;type=asp&amp;q=${token}" \
  --app "sbsch6pc?u=sbs&amp;type=asp&amp;q=${X}" --flashVer 'MAC 18,0,0,209' \
  -s 'http://vod.sbs.co.kr/onair/NeTVOnAir_1_4_2.swf?dd=9' \
  -t "rtmp://nlive.sbs.co.kr/sbsch6pc?u=sbs&amp;type=asp&amp;q=${X}" \
  -p 'http://vod.sbs.co.kr/onair/onair_index.jsp?Channem=SBS&amp;div=pc_onair' \
  -y "sbs1ch63.stream" | mplayer -
</code></pre>
<h2>Watching KBS1:</h2>
<p>Sending this wget request will provide you the valid secure token:</p>
<pre><code>wget -qO- --user-agent='YOUR_USER_AGENT' 'http://www.kbs.co.kr/player/player_playlist.php?ch=11' | awk '/movieListVstream/{ print $4 }' | sed -e 's/\["//;s/"\];//'
1tv_home.stream?id=2101&amp;si=9&amp;secure=TOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENT==&amp;csu=false
</code></pre>
<p>Now using this token is easy.
This script will allows you to watch KBS1:</p>
<pre><code>#!/bin/sh

token=$(wget -qO- --user-agent='YOUR_USER_AGENT' 'http://www.kbs.co.kr/player/player_playlist.php?ch=11' | awk '/movieListVstream/{ print $4 }' | sed -e 's/\["//;s/"\];//')
rtmpdump --resume -r "rtmp://live2.kbs.gscdn.com/1tv_home/_definst_/${token}" \
  --flashVer 'MAC 18,0,0,209' | mplayer -
</code></pre>
<h2>Watching KBS2:</h2>
<p>Sending this wget request will provide you the valid secure token:</p>
<pre><code>wget -qO- --user-agent='YOUR_USER_AGENT' 'http://www.kbs.co.kr/player/player_playlist.php?ch=11' | awk '/movieListVstream/{ print $4 }' | sed -e 's/\["//;s/"\];//'
1tv_home.stream?id=2101&amp;si=9&amp;secure=TOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENTOKENT==&amp;csu=false
</code></pre>
<p>Now using this token is easy.
This script will allows you to watch KBS2:</p>
<pre><code>#!/bin/sh

token=$(wget -qO- --user-agent='YOUR_USER_AGENT' 'http://www.kbs.co.kr/player/player_playlist.php?ch=11' | awk '/movieListVstream/{ print $4 }' | sed -e 's/\["//;s/"\];//')
rtmpdump --resume -r "rtmp://live2.kbs.gscdn.com/2tv_home/_definst_/${token}" \
  --flashVer 'MAC 18,0,0,209' | mplayer -
</code></pre>
<p>Now, Enjoy K-POP while finding 0days ~~~~~~~~~~~~</p>
        <div>
            <p class="text-muted">published on 2015-08-10 00:00:00 by Pierre Kim &lt;pierre.kim.sec@gmail.com&gt;</p>
        </div>
    </div>


<hr />

<h3>Older Posts</h3>

<table class="table table-striped">
    <thead>
        <tr>
            <th>Date</th>
            <th>Title</th>
        </tr>
    </thead>
    <tbody>
    
        <tr>
            <td>2015-07-27 00:00:00</td>
            <td><a href="2015-07-27-172-iptime-router-models-unauthenticated-RCE-with-DHCP-updated.html">updated - 172 ipTIME router models vulnerable to an unauthenticated RCE by sending a crafted DHCP request</a></td>
        </tr>
    
        <tr>
            <td>2015-07-22 01:00:00</td>
            <td><a href="2015-07-22-why-full-disclosure-is-the-solution-an-examble-with-ripe.html">Why Full Disclosure is the solution ? An example with RIPE</a></td>
        </tr>
    
        <tr>
            <td>2015-07-22 00:00:00</td>
            <td><a href="2015-07-22-using-linux-on-a-lg-13zd950.html">Using Linux (Debian 8) on a LG 13ZD950</a></td>
        </tr>
    
        <tr>
            <td>2015-07-16 00:00:00</td>
            <td><a href="2015-07-16-backdoor-and-RCE-found-in-8-TOTOLINK-products.html">Backdoor and RCE found in 8 TOTOLINK router models</a></td>
        </tr>
    
        <tr>
            <td>2015-07-16 00:00:00</td>
            <td><a href="2015-07-16-backdoor-credentials-found-in-4-TOTOLINK-products.html">Backdoor credentials found in 4 TOTOLINK router models</a></td>
        </tr>
    
        <tr>
            <td>2015-07-16 00:00:00</td>
            <td><a href="2015-07-16-4-TOTOLINK-products-vulnerable-to-CSRF-and-XSS-attacks.html">4 TOTOLINK router models vulnerable to CSRF and XSS attacks</a></td>
        </tr>
    
        <tr>
            <td>2015-07-16 00:00:00</td>
            <td><a href="2015-07-16-15-TOTOLINK-products-vulnerable-to-multiple-RCEs.html">15 TOTOLINK router models vulnerable to multiple RCEs</a></td>
        </tr>
    
        <tr>
            <td>2015-07-06 00:00:00</td>
            <td><a href="2015-07-06-127-iptime-router-models-unauthenticated-RCE-with-DHCP.html">127 ipTIME router models vulnerable to an unauthenticated RCE by sending a crafted DHCP request</a></td>
        </tr>
    
        <tr>
            <td>2015-07-03 00:00:00</td>
            <td><a href="2015-07-03-iptime-n104r3-vulnerable-to-CSRF-and-XSS-attacks.html">ipTIME n104r3 vulnerable to CSRF and XSS attacks</a></td>
        </tr>
    
        <tr>
            <td>2015-07-01 00:00:00</td>
            <td><a href="2015-07-01-poc-with-RCE-against-127-iptime-router-models.html">Exploit Code for ipTIME firmwares < 9.58 RCE with root privileges against 127 router models</a></td>
        </tr>
    
        <tr>
            <td>2015-06-23 00:00:00</td>
            <td><a href="2015-06-23-small-monitoring-system-using-freemobile.html">Small monitoring system using Freemobile</a></td>
        </tr>
    
        <tr>
            <td>2015-06-09 00:00:00</td>
            <td><a href="2015-06-09-recovering-windows-on-a-windows-free-lg-laptop.html">Recovering Windows on a "Windows-free" LG laptop</a></td>
        </tr>
    
        <tr>
            <td>2015-05-05 00:00:00</td>
            <td><a href="2015-05-05-127-iptime-routers-wifiaps-modems-firewalls-models-vulnerable-with-RCE-with-root-privileges.html">ERRATA - 127 ipTIME Routers/WiFi APs/Modems/Firewalls models vulnerable with RCE with root privileges</a></td>
        </tr>
    
        <tr>
            <td>2015-04-20 00:00:00</td>
            <td><a href="2015-04-20-112-iptime-routers-wifiaps-modems-firewalls-models-vulnerable-with-RCE-with-root-privileges.html">112 ipTIME Routers/WiFi APs/Modems/Firewalls models vulnerable with RCE with root privileges</a></td>
        </tr>
    
        <tr>
            <td>2015-04-08 00:00:00</td>
            <td><a href="2015-04-08-cve-2015-1415.html">CVE-2015-1415</a></td>
        </tr>
    
        <tr>
            <td>2015-04-07 00:00:00</td>
            <td><a href="2015-04-07-annyeong-haseyo.html">Annyeong haseyo!</a></td>
        </tr>
    
    </tbody>
</table>

</div>
</body>
</html>