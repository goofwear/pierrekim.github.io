<!DOCTYPE html>
<html>
<head>
<title>CVE-2015-5677 - FreeBSD bsnmpd information disclosure - A slice of Kimchi - IT Security Blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="feed.xml" rel="alternate" type="application/rss+xml" title="Blog" />
<style>
body {
    font-family: sans-serif;
    background-color: #fff;
    font-size: 16px;
}
h1, h2, h3, h4 {
    font-family: arial;
}
.container {
    max-width: 900px;
}
.footer {
    margin-top: 50px;
    font-size: 12px;
    text-align: center;
}
</style>
</head>
<body>
<div class="container">
    <div class="hero-unit faq">
        <div class="ac" style="text-align: center;">
            <h1>A slice of Kimchi - IT Security Blog</h1>
            <a href="../index.html">Home</a> &bull; <a href="about.html">About</a>  &bull; <a href="feed.xml">Feed</a>
        </div>
    </div>
    
<div class="hero-unit faq">
    <div class="ac">
        <h2>CVE-2015-5677 - FreeBSD bsnmpd information disclosure</h2>
    </div>
</div>

<div>
    <h2>Product Description</h2>
<p>The bsnmpd daemon serves the Internet SNMP (Simple Network Management
Protocol).  It is intended to serve only the absolute basic MIBs and
implement all other MIBs through loadable modules.</p>
<h2>Vulnerabilities Summary</h2>
<p>By default, the bsnmpd configuration file in FreeBSD 9.3 and 10.x has weak permissions
which allows a local user to retrieve sensitive information.</p>
<h2>Details</h2>
<p>By default the permissions of the bsnmpd configuration file are 0644 instead of 0600:</p>
<pre><code>root@freebsd-test-snmp:~ # ls -latr /etc/snmpd.config
-rw-r--r--  1 root  wheel  8662 Aug 12 16:27 /etc/snmpd.config
root@freebsd-test-snmp:~ #
</code></pre>
<p>This file is readable by a local user and contains the credentials for read-only and
read-write access (for SNMPv1, SNMPv2 and SNMPv3 protocols) and
gives a local user unnecessary/dangerous access:</p>
<pre><code>root@freebsd-test-snmp:~ # cat /etc/snmpd.config
[...]

# Change this!
read := "public"
# Uncomment begemotSnmpdCommunityString.0.2 below that sets the community
# string to enable write access.
write := "geheim"
trap := "mytrap"

[...]

# SNMPv3 USM User definition
#
# [...]
#
#user1 := "bsnmp"
#user1passwd := 0x22:0x98:0x1a:0x6e:0x39:0x93:0x16:0x5e:0x6a:0x21:0x1b:0xd8:0xa9:0x81:0x31:0x05:0x16:0x33:0x38:0x60

[...]
</code></pre>
<h2>Vendor Response</h2>
<p>The official patch does not fix the permissions for existing installations.</p>
<p>This vulnerability can be fixed by modifying the permission on
/etc/bsnmpd.conf to owner root:wheel and permission 0600.</p>
<h2>Report Timeline</h2>
<ul>
<li>Nov 04, 2015: Vulnerability found by Pierre Kim.</li>
<li>Nov 05, 2015: security-officer@freebsd.org is notified of the vulnerability.</li>
<li>Nov 07, 2015: security-officer@freebsd.org confirms the vulnerability but the patch in existing installations does not seem to be feasible.</li>
<li>Nov 11, 2015: Pierre Kim asks security-officer@freebsd.org for a CVE number, using FreeBSD CVE pool for future FreeBSD vulnerabilities.</li>
<li>Nov 11, 2015: security-officer@freebsd.org assigns CVE-2015-5677.</li>
<li>Jan 05, 2016: Pierre Kim asks the status of the vulnerability.</li>
<li>Jan 13, 2016: Pierre Kim states he will release a security advisory the Feb 05, 2016 after a 3-month embargo.</li>
<li>Jan 13, 2016: security-officer@freebsd.org confirms a security advisory will be issued on Jan 19, 2016.</li>
<li>Jan 14, 2016: An official advisory is published by FreeBSD.</li>
<li>Jan 15, 2016: A public advisory is sent to security mailing lists.</li>
</ul>
<h2>Credit</h2>
<p>This vulnerability was found by Pierre Kim (<a href="https://twitter.com/PierreKimSec">@PierreKimSec</a>).</p>
<h2>References</h2>
<p><a href="https://pierrekim.github.io/advisories/CVE-2015-5677-freebsd-bsnmpd.txt">https://pierrekim.github.io/advisories/CVE-2015-5677-freebsd-bsnmpd.txt</a></p>
<p><a href="https://pierrekim.github.io/blog/2016-01-15-cve-2015-5677-freebsd-bsnmpd.html">https://pierrekim.github.io/blog/2016-01-15-cve-2015-5677-freebsd-bsnmpd.html</a></p>
<p><a href="https://www.freebsd.org/security/advisories/FreeBSD-SA-16:06.bsnmpd.asc">https://www.freebsd.org/security/advisories/FreeBSD-SA-16:06.bsnmpd.asc</a></p>
<h2>Disclaimer</h2>
<p>This advisory is licensed under a Creative Commons Attribution Non-Commercial
Share-Alike 3.0 License: <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">http://creativecommons.org/licenses/by-nc-sa/3.0/</a></p>
    <div>
        <p class="text-muted">published on 2016-01-15 00:00:00 by Pierre Kim &lt;pierre.kim.sec@gmail.com&gt;</p>
    </div>
</div>

</div>
</body>
</html>